Лабораторная работа №2
Цель
Написать 2 докер-файла
1.	Плохой (bad_practice), в котором будут допущены намеренные ошибки, файл должен быть примером того, как делать не надо и опасно.
2.	Хороший (nice_practice), в котором исправлены ошибки “плохого” докер-файла.
После написания двух файлов, проанализировать результат и сделать выводы о том, как правильно и безопасно написать докер-файл.

Выполнение работы
Сначала я создал две директории: bad_practice – для докер-файла с ошибками, nice_practice – для исправленного. 
Давайте сравним хороший и плохой Dockerfile
Плохой


Хороший
 


Ошибки в докер фале:
1.	Cлишком общий базовый образ
•	Образ debian:bookworm - большой (100+ МБ), без предустановленного Python, он требует дополнительной установки и обновления пакетов.
•	python:3.11.4-slim - минимальный, оптимизированный для Python-приложений, безопаснее и быстрее собирается.

2.	Раздельные RUN-команды и отсутствие очистки кеша
Каждая команда RUN создаёт отдельный слой, что увеличивает размер образа.
Также кеш apt остаётся внутри слоя. В исправленном варианте всё объединено в одну команду, кеш удаляется - образ меньше и чище.

3.	Использование ADD вместо COPY
•	ADD автоматически распаковывает архивы и может скачивать файлы из интернета, что опасно.
•	COPY делает только одно. Он копирует локальные файлы. Это безопасно.

4.	Запуск под root и без WORKDIR
•	Запуск приложения от root - риск для безопасности. Если злоумышленник получит доступ, он сможет управлять всем контейнером.
•	Исправлено созданием непривилегированного пользователя и рабочей директории.

Теперь ошибки в файле docker_compose.yml
Плохой
 



Хороший
 
Ошибки:
1.	Запуск в привилегированном режиме
Режим privileged даёт контейнеру доступ к ядру и устройствам хоста.  В исправленном варианте контейнер работает с минимальными правами.
2.	использование network_mode: host
Хорошая практика - использовать стандартную docker-сеть, чтобы контейнеры общались между собой через имя сервиса.
3.	монтирование корня файловой системы хоста
•	Монтаж / даёт контейнеру доступ ко всем файлам хоста, включая системные.
•	В исправленном варианте монтируется только один файл-секрет, причём в режиме read-only.
Вывод
В результате выполнения этой лабораторной работы я разобрался не только в основынх ошибках при написании докер файла, но и об ошибках, которые можно допустить в yml файлах. Помимо этого, я узнал очень много новых команд Dockerfile и особенности их использования. Думаю, это полезный опыт. 
